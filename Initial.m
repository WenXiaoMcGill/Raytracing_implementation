% Initialization

wall = [1 2 8  7  0 0; ... 
        2 3 9  8  0 0; ... 
        3 4 10 9 0 0; ... 
        4 5 11 10 0 0; ... 
        5 6 12 11 0 0; ... 
        1 6 12 7 0 0; ...
        1 2 3  4  5 6; ...
        7 8 9 10 11 12];
    
vertex = [0  0   0; ...
          9  0   0; ...
          9  8   0; ...
          6  8   0; ...
          6  7.5 0; ...
          0  7.5 0; ...
          0  0   3.5; ...
          9  0   3.5; ...
          9  8   3.5; ...
          6  8   3.5; ...
          6  7.5 3.5; ...
          0  7.5 3.5; ...
          ];
      
S = [5 5 2];     % Set up the position of the sound source
R = [5 5 2];     % Set up the position of the listener
r = 0.5;             % Set up the radius of listener
N = 20*20;            % Set up the number of the rays ommited must be power of 2
delta = 0.005;        % Set up the absoption coefficient of the walls
alpha = 0.001;        % Set up the air absorption coefficient
c = 331.4 + 0.6*20; % Set up the sound speed
Po = 1/N;            % Set up the power of the sound
P_thresh = 0.001*Po;   % Set up the threshhold of the ray energy

% generate the function of every wall
wnum = size(wall,1);
plane = zeros(wnum,4);
for n = 1:1:wnum
    p1 = vertex(wall(n,2),:) - vertex(wall(n,1),:);
    p2 = vertex(wall(n,3),:) - vertex(wall(n,1),:);
    A = p1(2)*p2(3)-p2(2)*p1(3);
    B = p1(3)*p2(1)-p2(3)*p1(1);
    C = p1(1)*p2(2)-p2(1)*p1(2);
    D = -(A*vertex(wall(n,1),1)+B*vertex(wall(n,1),2)+C*vertex(wall(n,1),3));
    plane(n,:) = [A B C D];
end



